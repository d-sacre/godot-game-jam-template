@tool

extends GridContainer

################################################################################
#### CUSTOM SIGNAL DEFINITIONS #################################################
################################################################################
signal settings_value_changed

################################################################################
#### PRIVATE MEMBER VARIABLES ##################################################
################################################################################
var _keyChain : Array = []

################################################################################
#### EXPORT MEMBER VARIABLES ###################################################
################################################################################
@export_category("General")
@export var _name : String = "Name"

################################################################################
#### ONREADY MEMBER VARIABLES ##################################################
################################################################################
@onready var _nameLabel : Label = $name
@onready var _button : CheckButton = $button

################################################################################
#### PRIVATE MEMBER FUNCTIONS ##################################################
################################################################################
func _initialize_properties() -> void:
    self._nameLabel.text = self._name

################################################################################
#### PUBLIC MEMBER FUNCTIONS ###################################################
################################################################################
func initialize(keyChain : Array, toggled : bool) -> void:
    self._keyChain = keyChain
    self._button.set_pressed_no_signal(toggled)

func update_display(toggled : bool) -> void:
    self._button.set_pressed_no_signal(toggled)

################################################################################
#### SIGNAL HANDLING ###########################################################
################################################################################
func _on_button_toggled(toggled : bool) -> void:
    self.settings_value_changed.emit(self._keyChain, toggled)

################################################################################
#### GODOT LOADTIME FUNCTION OVERRIDES #########################################
################################################################################
func _ready() -> void:
    self._initialize_properties()

    self._button.toggled.connect(_on_button_toggled)

################################################################################
#### GODOT RUNTIME FUNCTION OVERRIDES ##########################################
################################################################################
func _process(_delta : float) -> void:
    if Engine.is_editor_hint():
        self._initialize_properties()